<!DOCTYPE html>
<html lang="it">
    <head>
        <link rel="icon" type="image/x-icon" href="https://www.legendarymotorsport.ro/wp-content/uploads/2022/06/Untitled-1.png">
        <meta charset="UTF-8">
        <title>Legendary Motorsport</title>
        <link rel="stylesheet" href="style.css">
        <script src="script.js"></script>
    </head>
    <body>
        <div class="navbar">
            <a href="homepage.html" class="active">HOME</a>
            <a href="about.html" class="active">ABOUT</a>
            <a href="contacts.html" class="active">CONTACTS</a>
        </div>
        <div class="sidebar">
            <img class="logo" src="miata-logo.png">
            <a style="padding-left: 13px; padding-right: 0px; font-size: medium;">Legendary Motorsport</a>
            <a style="border-top: 1px rgba(0, 0, 0, 0.288) solid;">Bruce Wayne</a>
            <a style="margin-top: -40px; font-weight:100;">Last Activity 25/03/2024</a>
        </div>
        <div class="clock">
            <h1><span id="hours">00</span>
            <span>:</span>
            <span id="minutes">00</span>
            <span>:</span>
            <span id="seconds">00</span>
        </div>

        <div class="cars"></div>
        <div class="arcobaleno"></div>
        
        <script src="./js/script.js"></script>
        <script>
            const carsContainer = document.getElementsByClassName('cars')[0];
            getCars().then(cars => {
                cars.forEach(car => {
                  
                    const carDiv = document.createElement('div');
                    carDiv.innerHTML = `
                <img src="${car.image}">
                <p class="parhome"p>Model: ${car.name}</p>
                <p class="parhome">Price: €${car.price}</p>
                    `;
                    carDiv.classList.add('car1');
                    carsContainer.appendChild(carDiv);
                })
            });
    
            /***
             * Funzione che riporta l'output di un servizio formattato in un code Element
             * @Parameters:
             * f: la funzione che restituisce l'output json del servizio
             * idCode: l'id dell'elemento in cui incollare il contenuto
             */
            async function showDataInCode(f, idCode) {
                const data = await f();
                const codeElement = document.getElementById(idCode);
                codeElement.innerHTML = JSON.stringify(data, null, 4);
            }
    
            /***
             * Funzione che aggiunge all'evento di apertura la chiamata al servizio del back-end
             * @Parameters:
             * type => il tipo di output da visualizzare, è il riferimento per:
             *  * la funzione (getXXXX)
             *  * l'elemento details (btnXXXX) a cui agganciare l'evento
             *  * l'elemento code (resultXXXX) in cui incollare il risultato
             */
            async function addToggleEventToDetail(type) {
                const detailElement = document.getElementById(`btn${type}`);
                detailElement.addEventListener("toggle", (event) => {
                    if (detailElement.open) {
                        showDataInCode(fetch[`get${type}`], `result${type}`)
                    }
                });
            }
    
            //Applico la logica di chiamata ed esposizione per tutti i 3 tipi di servizio che ho a disposizione
            ["Cars", "Techs", "Clothes"].forEach(type => addToggleEventToDetail(type));
            

            function time()
            {
                let clock=new Date()
                let hr=clock.getHours()
                let min=clock.getMinutes()
                let sec=clock.getSeconds()
                let hours=document.querySelector("#hours")
                if(hr>12)
                day.innerHTML="PM"
                if(hr>12)
                hr=hr-12
                if(hr<10)
                hr="0"+hr
                hours.innerHTML=hr
                let minutes=document.querySelector("#minutes")
                if(min<10)
                min="0"+min
                minutes.innerHTML=min
                let seconds=document.querySelector("#seconds")
                if(sec<10)
                sec="0"+sec
                seconds.innerHTML=sec
            }
            setInterval(time,1000)
        </script>
    </body>
</html>
